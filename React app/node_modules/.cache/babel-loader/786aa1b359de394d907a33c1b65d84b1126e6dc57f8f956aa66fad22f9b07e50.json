{"ast":null,"code":"import React,{useState,useEffect}from'react';import Sidebar from'./sidebar';import Main from'./main';import AddPage from'./addPage';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const App=()=>{const[authenticated,setAuthenticated]=useState(false);const[user,setUser]=useState(null);const[loading,setLoading]=useState(true);const[selectedFriend,setSelectedFriend]=useState(null);const[showMain,setShowmain]=useState(true);useEffect(()=>{const checkAuthStatus=async()=>{try{const response=await fetch('/auth-status',{method:'GET',credentials:'include'});const data=await response.json();setAuthenticated(data.authenticated);if(data.authenticated){setLoading(false);setUser(data.user);}}catch(error){console.error('Error checking auth status:',error);setLoading(false);}};checkAuthStatus();},[]);const handleAddFriend=async friendUID=>{if(friendUID===undefined){console.warn(\"Friend UID can't be null\");return;}try{const response=await fetch('/api/addFriend',{method:'POST',headers:{'Content-Type':'application/json'},credentials:'include',body:JSON.stringify({friendUID})});const data=await response.json();if(response.ok){console.log(\"Friend added successfully\",data);setShowmain(true);}else{console.error('Error adding friend:',data.error);}}catch(error){console.error('Error adding friend:',error);}};if(loading)return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});if(!authenticated)return/*#__PURE__*/_jsx(\"div\",{children:\"Please log in...\"});return/*#__PURE__*/_jsxs(\"div\",{className:\"app-container\",children:[/*#__PURE__*/_jsx(Sidebar,{user:user,setSelectedFriend:setSelectedFriend,showMain:showMain,setShowmain:setShowmain}),showMain?user?/*#__PURE__*/_jsx(Main,{user:user,selectedFriend:selectedFriend,setAuthenticated:setAuthenticated}):/*#__PURE__*/_jsx(\"div\",{children:\"No user found. Please log in.\"}):/*#__PURE__*/_jsx(AddPage,{handleAddFriend:handleAddFriend,setShowmain:setShowmain})]});};export default App;","map":{"version":3,"names":["React","useState","useEffect","Sidebar","Main","AddPage","jsx","_jsx","jsxs","_jsxs","App","authenticated","setAuthenticated","user","setUser","loading","setLoading","selectedFriend","setSelectedFriend","showMain","setShowmain","checkAuthStatus","response","fetch","method","credentials","data","json","error","console","handleAddFriend","friendUID","undefined","warn","headers","body","JSON","stringify","ok","log","children","className"],"sources":["C:/Users/Aniket Sahu/Desktop/Projects/Messaging site/React app/src/components/App.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport Sidebar from './sidebar';\r\nimport Main from './main';\r\nimport AddPage from './addPage';\r\nimport { type } from 'os';\r\n  \r\ninterface friends {\r\n    user_id: number;\r\n    friend_user_id: number;\r\n}\r\n\r\ninterface User {\r\n    user_id: number;\r\n    username: string;\r\n} \r\n\r\ninterface AuthStatus {\r\n    authenticated: boolean;\r\n    user: User;\r\n}  \r\n\r\ninterface addFriendResponse{\r\n    error?: string;\r\n    friend?: friends;\r\n}\r\n\r\nconst App: React.FC = () =>{\r\n    const [authenticated, setAuthenticated] = useState<boolean>(false);\r\n    const [user, setUser] = useState<User | null>(null);\r\n    const [loading, setLoading] = useState<boolean>(true); \r\n    const [selectedFriend, setSelectedFriend] = useState<User | null>(null);\r\n    const [showMain, setShowmain] = useState<boolean>(true);  \r\n\r\n    useEffect(() => {\r\n        const checkAuthStatus = async () => {\r\n            try {\r\n                const response = await fetch('/auth-status', {\r\n                    method: 'GET',\r\n                    credentials: 'include',\r\n                });\r\n                const data: AuthStatus = await response.json();\r\n                setAuthenticated(data.authenticated);\r\n                if (data.authenticated) {\r\n                    setLoading(false);\r\n                    setUser(data.user);\r\n                }\r\n            } catch (error) {\r\n                console.error('Error checking auth status:', error);    \r\n                setLoading(false); \r\n            }\r\n        };\r\n        checkAuthStatus();\r\n    }, []);\r\n\r\n    const handleAddFriend = async (friendUID: number | undefined): Promise<void>=> {\r\n        if(friendUID === undefined){\r\n            console.warn(\"Friend UID can't be null\");\r\n            return;\r\n        }\r\n        try {\r\n            const response = await fetch('/api/addFriend', {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                },\r\n                credentials: 'include',\r\n                body: JSON.stringify({ friendUID }),\r\n            });\r\n            const data: addFriendResponse = await response.json();\r\n            if (response.ok) {\r\n                console.log(\"Friend added successfully\", data);\r\n                setShowmain(true); \r\n            } else {\r\n                console.error('Error adding friend:', data.error);\r\n            }\r\n        } catch (error) {\r\n            console.error('Error adding friend:', error);\r\n        }\r\n    };\r\n    \r\n    if (loading) return <div>Loading...</div>;\r\n\r\n    if (!authenticated) return <div>Please log in...</div>;\r\n\r\n    return (\r\n        <div className=\"app-container\">\r\n            <Sidebar user={user} setSelectedFriend={setSelectedFriend} showMain={showMain} setShowmain={setShowmain} />\r\n            {showMain ? (\r\n                user ? ( \r\n                    <Main \r\n                        user={user} \r\n                        selectedFriend={selectedFriend} \r\n                        setAuthenticated={setAuthenticated}\r\n                    />\r\n                ) : (\r\n                    <div>No user found. Please log in.</div> \r\n                )\r\n            ) : (\r\n                <AddPage handleAddFriend={handleAddFriend} setShowmain={setShowmain}/>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default App;\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,MAAO,CAAAC,OAAO,KAAM,WAAW,CAC/B,MAAO,CAAAC,IAAI,KAAM,QAAQ,CACzB,MAAO,CAAAC,OAAO,KAAM,WAAW,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAuBhC,KAAM,CAAAC,GAAa,CAAGA,CAAA,GAAK,CACvB,KAAM,CAACC,aAAa,CAAEC,gBAAgB,CAAC,CAAGX,QAAQ,CAAU,KAAK,CAAC,CAClE,KAAM,CAACY,IAAI,CAAEC,OAAO,CAAC,CAAGb,QAAQ,CAAc,IAAI,CAAC,CACnD,KAAM,CAACc,OAAO,CAAEC,UAAU,CAAC,CAAGf,QAAQ,CAAU,IAAI,CAAC,CACrD,KAAM,CAACgB,cAAc,CAAEC,iBAAiB,CAAC,CAAGjB,QAAQ,CAAc,IAAI,CAAC,CACvE,KAAM,CAACkB,QAAQ,CAAEC,WAAW,CAAC,CAAGnB,QAAQ,CAAU,IAAI,CAAC,CAEvDC,SAAS,CAAC,IAAM,CACZ,KAAM,CAAAmB,eAAe,CAAG,KAAAA,CAAA,GAAY,CAChC,GAAI,CACA,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAAC,cAAc,CAAE,CACzCC,MAAM,CAAE,KAAK,CACbC,WAAW,CAAE,SACjB,CAAC,CAAC,CACF,KAAM,CAAAC,IAAgB,CAAG,KAAM,CAAAJ,QAAQ,CAACK,IAAI,CAAC,CAAC,CAC9Cf,gBAAgB,CAACc,IAAI,CAACf,aAAa,CAAC,CACpC,GAAIe,IAAI,CAACf,aAAa,CAAE,CACpBK,UAAU,CAAC,KAAK,CAAC,CACjBF,OAAO,CAACY,IAAI,CAACb,IAAI,CAAC,CACtB,CACJ,CAAE,MAAOe,KAAK,CAAE,CACZC,OAAO,CAACD,KAAK,CAAC,6BAA6B,CAAEA,KAAK,CAAC,CACnDZ,UAAU,CAAC,KAAK,CAAC,CACrB,CACJ,CAAC,CACDK,eAAe,CAAC,CAAC,CACrB,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAS,eAAe,CAAG,KAAO,CAAAC,SAA6B,EAAmB,CAC3E,GAAGA,SAAS,GAAKC,SAAS,CAAC,CACvBH,OAAO,CAACI,IAAI,CAAC,0BAA0B,CAAC,CACxC,OACJ,CACA,GAAI,CACA,KAAM,CAAAX,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAAC,gBAAgB,CAAE,CAC3CC,MAAM,CAAE,MAAM,CACdU,OAAO,CAAE,CACL,cAAc,CAAE,kBACpB,CAAC,CACDT,WAAW,CAAE,SAAS,CACtBU,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CAAEN,SAAU,CAAC,CACtC,CAAC,CAAC,CACF,KAAM,CAAAL,IAAuB,CAAG,KAAM,CAAAJ,QAAQ,CAACK,IAAI,CAAC,CAAC,CACrD,GAAIL,QAAQ,CAACgB,EAAE,CAAE,CACbT,OAAO,CAACU,GAAG,CAAC,2BAA2B,CAAEb,IAAI,CAAC,CAC9CN,WAAW,CAAC,IAAI,CAAC,CACrB,CAAC,IAAM,CACHS,OAAO,CAACD,KAAK,CAAC,sBAAsB,CAAEF,IAAI,CAACE,KAAK,CAAC,CACrD,CACJ,CAAE,MAAOA,KAAK,CAAE,CACZC,OAAO,CAACD,KAAK,CAAC,sBAAsB,CAAEA,KAAK,CAAC,CAChD,CACJ,CAAC,CAED,GAAIb,OAAO,CAAE,mBAAOR,IAAA,QAAAiC,QAAA,CAAK,YAAU,CAAK,CAAC,CAEzC,GAAI,CAAC7B,aAAa,CAAE,mBAAOJ,IAAA,QAAAiC,QAAA,CAAK,kBAAgB,CAAK,CAAC,CAEtD,mBACI/B,KAAA,QAAKgC,SAAS,CAAC,eAAe,CAAAD,QAAA,eAC1BjC,IAAA,CAACJ,OAAO,EAACU,IAAI,CAAEA,IAAK,CAACK,iBAAiB,CAAEA,iBAAkB,CAACC,QAAQ,CAAEA,QAAS,CAACC,WAAW,CAAEA,WAAY,CAAE,CAAC,CAC1GD,QAAQ,CACLN,IAAI,cACAN,IAAA,CAACH,IAAI,EACDS,IAAI,CAAEA,IAAK,CACXI,cAAc,CAAEA,cAAe,CAC/BL,gBAAgB,CAAEA,gBAAiB,CACtC,CAAC,cAEFL,IAAA,QAAAiC,QAAA,CAAK,+BAA6B,CAAK,CAC1C,cAEDjC,IAAA,CAACF,OAAO,EAACyB,eAAe,CAAEA,eAAgB,CAACV,WAAW,CAAEA,WAAY,CAAC,CACxE,EACA,CAAC,CAEd,CAAC,CAED,cAAe,CAAAV,GAAG","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}