{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Aniket Sahu\\\\Desktop\\\\Projects\\\\Messaging site\\\\React app\\\\src\\\\components\\\\main.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState } from \"react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction Main({\n  user,\n  selectedFriend\n}) {\n  _s();\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState(\"\");\n  useEffect(() => {\n    fetchMessages();\n  }, [selectedFriend]);\n  const fetchMessages = async () => {\n    if (!selectedFriend) return;\n    try {\n      const response = await fetch(`/api/messages?friendId=${selectedFriend.id}`, {\n        method: 'GET',\n        credentials: 'include'\n      });\n      const data = await response.json();\n      const sortedMessages = data.messages.sort((a, b) => new Date(a.time) - new Date(b.time));\n      setMessages(sortedMessages);\n    } catch (error) {\n      console.error('Error fetching messages:', error);\n    }\n  };\n  const messageSent = async message => {\n    try {\n      const response = await fetch('/api/sendMessage', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        credentials: 'include',\n        body: JSON.stringify({\n          message,\n          friendId: selectedFriend.id\n        })\n      });\n      const data = await response.json();\n      if (response.ok) {\n        setMessages(prevMessages => [...prevMessages, data]);\n        setNewMessage(\"\");\n      }\n    } catch (error) {\n      console.error('Error sending message', error);\n    }\n  };\n  const handleSendMessage = e => {\n    e.preventDefault();\n    if (newMessage.trim()) {\n      messageSent(newMessage);\n    }\n  };\n  const handleLogout = async () => {\n    try {\n      const response = await fetch('/logout', {\n        method: 'GET',\n        credentials: 'include'\n      });\n      if (response.ok) {\n        navigate('/');\n      } else {\n        console.error(\"Logout failed\");\n      }\n    } catch (error) {\n      console.error('Error during logout:', error);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"main-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"main-header\",\n      children: [selectedFriend ? selectedFriend.name : \"Select a friend\", /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleLogout,\n        children: \"Logout\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"main-messages\",\n      children: messages.map((msg, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: msg.sender === selectedFriend.name ? \"friend-message\" : \"user-message\",\n        children: /*#__PURE__*/_jsxDEV(\"span\", {\n          children: msg.message\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 25\n        }, this)\n      }, index, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 21\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"main-input\",\n      children: /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSendMessage,\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          placeholder: \"Type your message...\",\n          value: newMessage,\n          onChange: e => setNewMessage(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          children: \"Send\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 74,\n    columnNumber: 9\n  }, this);\n}\n_s(Main, \"bFuYpZWMfOU2WhBa/CyaGkj6fmk=\");\n_c = Main;\nexport default Main;\nvar _c;\n$RefreshReg$(_c, \"Main\");","map":{"version":3,"names":["React","useState","jsxDEV","_jsxDEV","Main","user","selectedFriend","_s","messages","setMessages","newMessage","setNewMessage","useEffect","fetchMessages","response","fetch","id","method","credentials","data","json","sortedMessages","sort","a","b","Date","time","error","console","messageSent","message","headers","body","JSON","stringify","friendId","ok","prevMessages","handleSendMessage","e","preventDefault","trim","handleLogout","navigate","className","children","name","onClick","fileName","_jsxFileName","lineNumber","columnNumber","map","msg","index","sender","onSubmit","type","placeholder","value","onChange","target","_c","$RefreshReg$"],"sources":["C:/Users/Aniket Sahu/Desktop/Projects/Messaging site/React app/src/components/main.jsx"],"sourcesContent":["import React, { useState } from \"react\";\r\n\r\nfunction Main({ user, selectedFriend }) {\r\n    const [messages, setMessages] = useState([]);\r\n    const [newMessage, setNewMessage] = useState(\"\");\r\n\r\n    useEffect(() => {\r\n        fetchMessages();\r\n    }, [selectedFriend]);\r\n\r\n    const fetchMessages = async () => {\r\n        if (!selectedFriend) return;\r\n\r\n        try {\r\n            const response = await fetch(`/api/messages?friendId=${selectedFriend.id}`, {\r\n                method: 'GET',\r\n                credentials: 'include',\r\n            });\r\n            const data = await response.json();\r\n            const sortedMessages = data.messages.sort((a, b) => new Date(a.time) - new Date(b.time));\r\n            setMessages(sortedMessages);\r\n        } catch (error) {\r\n            console.error('Error fetching messages:', error);\r\n        }\r\n    };\r\n\r\n    const messageSent = async (message) => {\r\n        try {\r\n            const response = await fetch('/api/sendMessage', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                credentials: 'include',\r\n                body: JSON.stringify({\r\n                    message,\r\n                    friendId: selectedFriend.id,\r\n                }),\r\n            });\r\n            const data = await response.json();\r\n\r\n            if (response.ok) {\r\n                setMessages((prevMessages) => [...prevMessages, data]);\r\n                setNewMessage(\"\");\r\n            }\r\n        } catch (error) {\r\n            console.error('Error sending message', error);\r\n        }\r\n    };\r\n\r\n    const handleSendMessage = (e) => {\r\n        e.preventDefault();\r\n        if (newMessage.trim()) {\r\n            messageSent(newMessage);\r\n        }\r\n    };\r\n\r\n    const handleLogout = async () => {\r\n        try {\r\n            const response = await fetch('/logout', {\r\n                method: 'GET',\r\n                credentials: 'include',\r\n            });\r\n\r\n            if (response.ok) {\r\n                navigate('/');\r\n            } else {\r\n                console.error(\"Logout failed\");\r\n            }\r\n        } catch (error) {\r\n            console.error('Error during logout:', error);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"main-container\">\r\n            <div className=\"main-header\">\r\n                {selectedFriend ? selectedFriend.name : \"Select a friend\"}\r\n                <button onClick={handleLogout}>Logout</button>\r\n            </div>\r\n            <div className=\"main-messages\">\r\n                {messages.map((msg, index) => (\r\n                    <div\r\n                        key={index}\r\n                        className={msg.sender === selectedFriend.name ? \"friend-message\" : \"user-message\"}>\r\n                        <span>{msg.message}</span>\r\n                    </div>\r\n                ))}\r\n            </div>\r\n            <div className=\"main-input\">\r\n                <form onSubmit={handleSendMessage}>\r\n                    <input\r\n                        type=\"text\"\r\n                        placeholder=\"Type your message...\"\r\n                        value={newMessage}\r\n                        onChange={(e) => setNewMessage(e.target.value)}\r\n                    />\r\n                    <button type=\"submit\">Send</button>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Main;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}